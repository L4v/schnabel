sudo: required
language: java
jdk: openjdk11

#secure: "D5Myz2Bacu+AjRIWWT5L1Wxd/T7Tw0QF2WTEbtBlfBKxsRng7pkRM66rFhaF0DfS28ShIlxeQcH6ptnNfcYzm4KoAz8ATsdDBTZRzqJNgMajcN6EKLWYDHoNEfAGJwXmkMBClgkJcTIUDOdrnVPnMVhburCt8MN6+wFDds8Zl+LES82fu6XISLOSdkql8eeWwj/2aN35qZ6EX3AeNZV69B/VNPqTcVUyXOGI/gfP9SVnIlXSaI4H0VV5xeTsNUCG2WwcuSAqi0Jp7zbnjZt6r6uhpNv3PFfy1K/hJt6lDDWrzyg/XOj1QCt2vDxy7VI5VkLMkR3vhyvaE8rRNhoNfslsFKAJddyWohjOI4JQhfDb13TMCzI5K5inil2IjR2tmT/pS6/dU6sRVfj1f0vMZM5cVBi+/ne06TfvdCNX1K+yuBIerRx9ZyKzWMv/11dwQP3uw7Dxz3iBe/dJuh7gbVxQgkN0ELaxnuPyPUGCw9wh8JSBjYohbpT7RFCxyDycp8zcmYT7zqNuW11U1qVAGXdGVazhMDLg18wzO6Re/f1zY8Rm7irp+eUkhiixTmn5rNC0/sWQKwwN8kd042LtPTwvtAFpAVucO/speJW/E2YhA5/RVFiy+dZSk5hjMih5hIDcUq0tVASBqqukNfEzYODjj6wnVg4QeIiw5LT7Gzc="

services:
  - postgresql

before_install:
  - chmod +x mvnw

before_script:
  - psql -c "CREATE DATABASE isadb;" -U postgres
  - psql -c "CREATE USER isa WITH PASSWORD 'isa';" -U postgres

addons:
  sonarcloud:
    organization: "schnabelorg"
    token:
      secure: "D5Myz2Bacu+AjRIWWT5L1Wxd/T7Tw0QF2WTEbtBlfBKxsRng7pkRM66rFhaF0DfS28ShIlxeQcH6ptnNfcYzm4KoAz8ATsdDBTZRzqJNgMajcN6EKLWYDHoNEfAGJwXmkMBClgkJcTIUDOdrnVPnMVhburCt8MN6+wFDds8Zl+LES82fu6XISLOSdkql8eeWwj/2aN35qZ6EX3AeNZV69B/VNPqTcVUyXOGI/gfP9SVnIlXSaI4H0VV5xeTsNUCG2WwcuSAqi0Jp7zbnjZt6r6uhpNv3PFfy1K/hJt6lDDWrzyg/XOj1QCt2vDxy7VI5VkLMkR3vhyvaE8rRNhoNfslsFKAJddyWohjOI4JQhfDb13TMCzI5K5inil2IjR2tmT/pS6/dU6sRVfj1f0vMZM5cVBi+/ne06TfvdCNX1K+yuBIerRx9ZyKzWMv/11dwQP3uw7Dxz3iBe/dJuh7gbVxQgkN0ELaxnuPyPUGCw9wh8JSBjYohbpT7RFCxyDycp8zcmYT7zqNuW11U1qVAGXdGVazhMDLg18wzO6Re/f1zY8Rm7irp+eUkhiixTmn5rNC0/sWQKwwN8kd042LtPTwvtAFpAVucO/speJW/E2YhA5/RVFiy+dZSk5hjMih5hIDcUq0tVASBqqukNfEzYODjj6wnVg4QeIiw5LT7Gzc="


script:
  - ./mvnw clean install -DskipTests=false -B
  # the following command line builds the project, runs the tests with coverage and then execute the SonarCloud analysis
  - ./mvnw sonar:sonar -Dsonar.projectKey=$PROJECT_KEY -Dsonar.organization=SchnabelORG_schnabel -Dsonar.host.url=https://sonarcloud.io -Dsonar.login=$SONAR_TOKEN

dist: trusty

deploy:
  provider: heroku
  api_key: $HEROKU_API_KEY
  app: schnabel
